---
// src/pages/admin.astro
import '../styles/global.css';
export const prerender = true;
---

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>内容管理系统 - 旅游网站</title>
  <link rel="stylesheet" href="https://unpkg.com/decap-cms@3.9.0/dist/cms.css">
</head>
<body>
  <!-- Decap CMS 标准挂载点 -->
  <div id="nc-root"></div>

  <!-- 确保 CMS 脚本在页面加载完成后执行 -->
  <script is:inline>
    // 设置手动初始化标志
    window.CMS_MANUAL_INIT = true;

    // 动态加载 Decap CMS 脚本
    window.addEventListener('DOMContentLoaded', function() {
      const script = document.createElement('script');
      script.src = 'https://unpkg.com/decap-cms@3.9.0/dist/decap-cms.js';
      script.onload = function() {
        // 确保 CMS 对象可用后再初始化
        if (window.CMS) {
          window.CMS.init({
            config: {
              backend: {
                name: 'github',
                repo: 'ChrisHu2025/travel-website',
                branch: 'main',
                auth_scope: 'repo',
                client_id: 'Ov23liJds0MQcgZsIeob'
              }
            }
          });
        }
      };
      document.body.appendChild(script);
    });
  </script>
</body>
</html>
