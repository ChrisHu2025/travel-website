---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
  const entries = await getCollection('destinations');
  return entries.map(entry => ({
    params: { slug: entry.data.path },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={`${entry.data.title} - Explore China`}>
  <article class="bg-white min-h-screen pb-20">

    <!-- Hero Image -->
    <div class="relative w-full h-[60vh] lg:h-[80vh] bg-gray-900">
      <img
        src={entry.data.image}
        alt={entry.data.title}
        class="absolute inset-0 w-full h-full object-cover opacity-95"
      />
      <div class="absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"></div>
    </div>

    <!-- Article Container -->
    <div class="container mx-auto px-4 max-w-3xl -mt-24 relative z-10">
      <div class="bg-white p-8 md:p-16 shadow-2xl rounded-sm">

        <!-- Header -->
        <header class="text-center mb-14 border-b border-gray-100 pb-10">
          <nav class="text-xs font-bold tracking-[0.2em] text-gray-400 uppercase mb-6 flex justify-center items-center gap-2">
            <a href="/destinations" class="hover:text-black transition-colors">Destinations</a>
            <span class="text-gray-300">/</span>
            <span class="text-gray-800">{entry.data.region}</span>
          </nav>

          <h1 class="text-4xl md:text-6xl font-serif font-bold text-gray-900 mb-8 leading-tight">
            {entry.data.title}
          </h1>

          <!-- ✅ Travel Essentials: 极简风格 (无背景框) -->
          <div class="flex flex-col sm:flex-row justify-center items-center gap-6 sm:gap-12 text-sm font-sans text-gray-600 border-t border-gray-50 pt-8 mt-8">
            <div class="flex items-center gap-2">
              <span class="text-xs font-bold text-gray-400 uppercase tracking-widest">Location</span>
              <!-- City Link -->
              <a href={`/destinations/${entry.data.city.toLowerCase()}`} class="font-medium text-gray-900 border-b border-gray-200 hover:border-indigo-600 transition-colors">
                {entry.data.city}
              </a>
            </div>
            <div class="flex items-center gap-2">
              <span class="text-xs font-bold text-gray-400 uppercase tracking-widest">Best Season</span>
              <span class="font-medium text-gray-900">{entry.data.best_season.join(', ')}</span>
            </div>
          </div>
        </header>

        <!-- Intro Summary (SEO Friendly) -->
        <div class="prose prose-lg prose-indigo mx-auto mb-12">
          <p class="font-serif text-xl md:text-2xl leading-relaxed text-gray-600 italic">
            {entry.data.summary}
          </p>
        </div>

        <!-- Markdown Body -->
        <div class="prose prose-lg prose-indigo mx-auto font-sans text-gray-800 prose-headings:font-serif prose-img:rounded-sm prose-img:shadow-lg">
          <Content />
        </div>

      </div>
    </div>
  </article>
</Layout>
