---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allDestinations = await getCollection('destinations');
const regions = [...new Set(allDestinations.map(d => d.data.region))];
---

<Layout title="All Destinations - Explore China">
  <div class="min-h-screen bg-white py-16">
    <div class="container mx-auto px-4">
      <header class="text-center mb-24">
        <h1 class="text-5xl md:text-7xl font-serif font-bold text-gray-900 mb-6 tracking-tight">Destinations</h1>
        <p class="text-xl text-gray-500 font-serif italic max-w-2xl mx-auto">Curated guides to China's most breathtaking regions.</p>
      </header>

      <div class="space-y-32">
        {regions.map(region => (
          <section>
            <div class="flex items-end justify-between mb-12 border-b border-gray-100 pb-4">
              <h2 class="text-3xl font-serif font-bold text-gray-900">{region}</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-12">
              {allDestinations.filter(d => d.data.region === region).map((item) => (
                <article class="group cursor-pointer">
                  <a href={`/destinations/${item.data.path}/`} class="block mb-5 overflow-hidden bg-gray-100 relative aspect-[3/4]">
                    <img src={item.data.image} alt={item.data.title} class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-105" />
                  </a>
                  <div class="flex flex-col">
                    <span class="text-[10px] font-bold tracking-widest text-indigo-600 uppercase mb-2">{item.data.city}</span>
                    <h3 class="text-xl font-serif font-bold text-gray-900 leading-snug mb-2 group-hover:text-gray-600 transition-colors">
                      <a href={`/destinations/${item.data.path}/`}>{item.data.card_title}</a>
                    </h3>
                  </div>
                </article>
              ))}
            </div>
          </section>
        ))}
      </div>
    </div>
  </div>
</Layout>
