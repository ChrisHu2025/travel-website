---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const allStories = await getCollection('stories');
const sortedStories = allStories.sort((a, b) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf());
---

<Layout title="Travel Stories - Explore China">
  <div class="min-h-screen bg-white py-16">
    <div class="container mx-auto px-4">
      <header class="text-center mb-24">
        <h1 class="text-5xl md:text-7xl font-serif font-bold text-gray-900 mb-6 tracking-tight">Stories</h1>
        <p class="text-xl text-gray-500 font-serif italic max-w-2xl mx-auto">First-hand accounts from the road.</p>
      </header>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-8 gap-y-16">
        {sortedStories.map((item) => (
          <article class="group flex flex-col h-full">
            <a href={`/stories/${item.data.path}/`} class="block mb-6 overflow-hidden aspect-[4/3] bg-gray-100">
              <img src={item.data.image} alt={item.data.title} class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" />
            </a>
            <div class="flex-grow">
              <div class="flex items-center text-xs font-bold text-gray-400 uppercase tracking-widest mb-3">
                <span class="text-indigo-600">{item.data.city}</span>
                <span class="mx-2">â€¢</span>
                <time>{new Date(item.data.date).toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}</time>
              </div>
              <h3 class="text-2xl font-serif font-bold text-gray-900 mb-3 leading-tight group-hover:text-gray-600 transition-colors">
                <a href={`/stories/${item.data.path}/`}>{item.data.card_title}</a>
              </h3>
              <p class="text-gray-500 text-sm leading-relaxed line-clamp-3 font-sans">{item.data.card_summary}</p>
            </div>
          </article>
        ))}
      </div>
    </div>
  </div>
</Layout>
